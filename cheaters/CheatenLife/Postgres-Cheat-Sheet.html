<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Postgres Cheat Sheet</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 48pt; }
 .h1, h1 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 18pt; }
 .s2 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 18pt; vertical-align: 3pt; }
 h2 { color: #231F20; font-family:"Courier New", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 14pt; }
 .s3 { color: #231F20; font-family:"Courier New", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 .s4 { color: #010202; font-family:"Roboto Slab", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25.5pt; }
 .a, a { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s6 { color: #231F20; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s7 { color: #231F20; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 18pt; vertical-align: -3pt; }
 h3 { color: #231F20; font-family:"Courier New", serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .p, p { color: #231F20; font-family:"Courier New", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; margin:0pt; }
</style></head><body><p class="s1" style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">PostgreSQL Cheat Sheet  </p><h1 style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Queries <span class="s2">psql</span></h1><h2 style="padding-top: 6pt;padding-left: 26pt;text-indent: -16pt;line-height: 106%;text-align: left;">SELECT <span class="s3">name, price FROM Parts WHERE id=123 OR quantity&gt;0 ORDER BY name DESC;</span></h2><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-left: 9pt;text-indent: 0pt;line-height: 106%;text-align: left;">-- Average price for each vendor: SELECT vendor_id, avg(price) from Parts</p><p class="s3" style="padding-left: 26pt;text-indent: 0pt;line-height: 16pt;text-align: left;">GROUP BY vendor_id;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-left: 9pt;text-indent: 0pt;line-height: 106%;text-align: left;">-- Average price for certain vendors: SELECT vendor_id, avg(price) from Parts</p><p class="s3" style="padding-left: 26pt;text-indent: 0pt;line-height: 106%;text-align: left;">WHERE vendor_id IN (1, 2) GROUP BY vendor_id;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-left: 9pt;text-indent: 0pt;line-height: 106%;text-align: left;">SELECT max(price), min(price) FROM Parts; SELECT COUNT(*) FROM Parts;</p><p class="s3" style="padding-left: 9pt;text-indent: 0pt;line-height: 16pt;text-align: left;">SELECT * FROM Parts WHERE name LIKE &#39;Grey%&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 9pt;padding-left: 13pt;text-indent: 0pt;text-align: left;">Joins</h1><p class="s3" style="padding-top: 3pt;padding-left: 9pt;text-indent: 0pt;line-height: 106%;text-align: left;">SELECT parts.name, parts.price, vendor.name as VendorName</p><p class="s3" style="padding-left: 18pt;text-indent: 0pt;line-height: 16pt;text-align: left;">FROM parts, vendors</p><p class="s3" style="padding-left: 18pt;text-indent: 0pt;line-height: 106%;text-align: left;">WHERE parts.vendor_id = vendors.id ORDER BY VendorName, parts.name;</p><p class="s3" style="padding-top: 2pt;padding-left: 13pt;text-indent: 0pt;text-align: left;">psql -h hostname -U username db-name</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 13pt;text-indent: 0pt;text-align: left;">\d <span class="s3">-- list tables, views, seqs</span></h2><h2 style="padding-left: 13pt;text-indent: 0pt;text-align: left;">\c <span class="s3">other-db -- connect to another db</span></h2><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 13pt;text-indent: 0pt;text-align: left;">-- Send query results to a file:</h2><h2 style="padding-left: 13pt;text-indent: 0pt;text-align: left;">\copy <span class="s3">(SELECT 2+2) TO &#39;/tmp/outfile&#39;</span></h2><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 13pt;text-indent: 0pt;text-align: left;">-- Read commands from a file:</h2><h2 style="padding-left: 13pt;text-indent: 0pt;text-align: left;">\i <span class="s3">/path/to/file.sql</span></h2><p style="text-indent: 0pt;text-align: left;"><br/></p><h2 style="padding-left: 13pt;text-indent: 0pt;text-align: left;">\? <span class="s3">-- list all commands</span></h2><h1 style="padding-top: 14pt;padding-left: 13pt;text-indent: 0pt;text-align: left;">Transactions</h1><p class="s3" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">BEGIN TRANSACTION;</p><p class="s3" style="padding-left: 16pt;text-indent: 0pt;line-height: 106%;text-align: left;">-- do stuff COMMIT;</p><p class="s3" style="padding-left: 16pt;text-indent: 0pt;line-height: 106%;text-align: left;">-- or -- ROLLBACK;</p><h1 style="padding-top: 11pt;padding-left: 9pt;text-indent: 0pt;text-align: left;">JSON</h1><p class="s3" style="padding-top: 3pt;padding-left: 30pt;text-indent: -16pt;line-height: 106%;text-align: left;">SELECT id, name, attributes-&gt;&#39;frob&#39; FROM parts</p><p class="s3" style="padding-left: 13pt;text-indent: 16pt;line-height: 106%;text-align: left;">WHERE attributes @&gt; &#39;{&quot;usefulness&quot; : &quot;high&quot;}&#39;;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="text-indent: 0pt;text-align: left;">Database Labs</p><p style="text-indent: 0pt;text-align: left;"/><p style="padding-left: 237pt;text-indent: 0pt;text-align: left;"><a href="mailto:support@databaselabs.io" class="a" target="_blank">Postgres Database as a Service • Suggestions: </a><a href="mailto:support@databaselabs.io" target="_blank">support@databaselabs.io</a></p><p class="s6" style="padding-top: 1pt;padding-left: 237pt;text-indent: 0pt;text-align: left;">Copyright © 2016 Database Labs LLC. All rights reserved.</p><p class="s1" style="padding-top: 5pt;padding-left: 244pt;text-indent: 0pt;text-align: left;"> PostgreSQL Cheat Sheet</p><p class="s7" style="padding-top: 3pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">Tables <span class="h1">Common Data Types</span></p><h3 style="padding-top: 5pt;padding-left: 28pt;text-indent: -14pt;line-height: 106%;text-align: left;">CREATE TABLE <span class="p">Vendors ( id SERIAL PRIMARY KEY,</span></h3><p style="padding-left: 28pt;text-indent: 0pt;line-height: 14pt;text-align: left;">name TEXT UNIQUE NOT NULL);</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 14pt;text-indent: 0pt;text-align: left;">CREATE TABLE <span class="p">Parts (</span></h3><p style="padding-left: 28pt;text-indent: 0pt;line-height: 106%;text-align: left;">id SERIAL PRIMARY KEY, name TEXT UNIQUE NOT NULL,</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 106%;text-align: left;">quantity INTEGER, price NUMERIC, attributes JSONB,</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 14pt;text-align: left;">vendor_id INTEGER NOT NULL REFERENCES</p><p style="padding-left: 14pt;text-indent: 0pt;text-align: left;">vendors(id),</p><p style="padding-left: 14pt;text-indent: 14pt;line-height: 106%;text-align: left;">createdAt TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now());</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 14pt;text-indent: 0pt;line-height: 106%;text-align: justify;">ALTER TABLE <span class="p">Parts ADD COLUMN description TEXT; ALTER TABLE Parts RENAME COLUMN description TO descr;</span></h3><p style="padding-left: 14pt;text-indent: 0pt;line-height: 14pt;text-align: left;">ALTER TABLE Parts DROP COLUMN descr;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 14pt;text-indent: 0pt;line-height: 106%;text-align: left;">ALTER TABLE Parts ALTER COLUMN quantity SET NOT NULL;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 14pt;text-indent: 0pt;text-align: left;">ALTER TABLE Parts RENAME TO PartsTable;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 14pt;text-indent: 0pt;text-align: left;">DROP TABLE <span class="p">Parts;</span></h3><h3 style="padding-top: 2pt;padding-left: 14pt;text-indent: 0pt;line-height: 106%;text-align: left;">INTEGER<span class="p">, BIGINT - signed 4/8 byte integers </span>SERIAL<span class="p">, BIGSERIAL - auto-incrementing integers </span>UUID <span class="p">- universally unique identifier</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 14pt;text-indent: 0pt;text-align: left;">REAL, DOUBLE <span class="p">- floating point number</span></h3><h3 style="padding-left: 14pt;text-indent: 0pt;text-align: left;">NUMERIC <span class="p">- fixed point number - for money</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 14pt;text-indent: 0pt;line-height: 106%;text-align: left;">DATE <span class="p">- month, day, year </span>TIME <span class="p">- time of day </span>INTERVAL <span class="p">- timespan</span></h3><h3 style="padding-left: 14pt;text-indent: 0pt;line-height: 14pt;text-align: left;">TIMESTAMP <span class="p">WITH TIME ZONE - time + date</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 14pt;text-indent: 0pt;line-height: 106%;text-align: left;">TEXT <span class="p">- variable length string </span>VARCHAR<span class="p">(x) - variable length up to x </span>CHARACTER<span class="p">(x) - fixed x-length string </span>JSONB <span class="p">- compressed JSON data</span></h3><h1 style="padding-top: 10pt;padding-left: 14pt;text-indent: 0pt;text-align: left;">Insert, Update, Delete</h1><h3 style="padding-top: 1pt;padding-left: 18pt;text-indent: 0pt;line-height: 106%;text-align: left;">INSERT INTO <span class="p">Vendors (Name) VALUES (&#39;A Vendor&#39;); INSERT INTO Vendors (Name) VALUES (&#39;Other Vendor&#39;);</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 18pt;text-indent: 0pt;line-height: 106%;text-align: left;">INSERT INTO Parts (name, quantity, price, attributes,vendor_id) VALUES (&#39;Grey Widget&#39;, 12, 1.23,&#39;{&quot;frob&quot;:12,&quot;usefulness&quot;:&quot;high&quot;}&#39;,(SELECT ID FROM vendors WHERE name=&#39;A Vendor&#39;));</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h3 style="padding-left: 39pt;text-indent: -21pt;line-height: 106%;text-align: left;">UPDATE <span class="p">Vendors SET name=&#39;A Vendor, Inc.&#39; WHERE NAME=&#39;A Vendor&#39;;</span></h3><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="text-indent: 0pt;text-align: left;">Database Labs</p><p style="text-indent: 0pt;text-align: left;"/><h3 style="padding-top: 5pt;padding-left: 380pt;text-indent: 0pt;text-align: left;">DELETE FROM <span class="p">Parts WHERE name=&#39;Grey Widget&#39;;</span></h3><p style="padding-top: 6pt;padding-left: 234pt;text-indent: 0pt;text-align: left;"><a href="mailto:support@databaselabs.io" class="a" target="_blank">Postgres Database as a Service • Suggestions: </a><a href="mailto:support@databaselabs.io" target="_blank">support@databaselabs.io</a></p><p class="s6" style="padding-top: 2pt;padding-left: 235pt;text-indent: 0pt;text-align: left;">Copyright © 2016 Database Labs LLC. All rights reserved.</p></body></html>
