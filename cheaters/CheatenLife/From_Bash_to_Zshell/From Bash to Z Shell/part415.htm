<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Tag Labels</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part414.htm">&lt; Previous</a><span> | </span><a href="../From Bash to Z Shell.html">Contents</a><span> | </span><a href="part416.htm">Next &gt;</a></p><p class="s35" style="padding-left: 42pt;text-indent: 0pt;text-align: left;"><a name="bookmark767">Tag Labels</a></p><p style="padding-top: 5pt;padding-left: 41pt;text-indent: 0pt;line-height: 115%;text-align: left;">Tag labels provide a way of performing completion for a particular tag more than once. Typi- cally it is used in conjunction with the <span class="s33">ignored-patterns </span>style to break up matches for a style into subgroups. As an example, let’s consider completion of options to the <span class="s33">configure </span>scripts that come with the source to many programs. Often they allow you to enable or disable various features via options with names starting <span class="s33">--enable </span>or <span class="s33">--disable</span>. For example, <span class="s33">zsh</span>’s <span class="s33">configure </span>script has a <span class="s33">--enable-maildir-support </span>option that enables support for maildir mailboxes— an alternative way to store e-mail messages—for the <span class="s33">MAIL </span>variable we saw in Chapter 7. For every <span class="s33">--enable </span>option there is always a corresponding <span class="s33">--disable </span>option, so listing both is not entirely useful. What we can do is arrange for the <span class="s33">--disable </span>options to be tried only after comple- tion for other options has been tried. The fourth component of the zstyle context contains the</p><p class="s29" style="padding-top: 3pt;padding-left: 223pt;text-indent: 0pt;text-align: left;"><a name="bookmark808">CHAPTER 15 </a><span class="s28">■ </span>W RIT ING COMP LET ION F UNCTI ON S <span class="s27">397</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 40pt;text-indent: 0pt;line-height: 115%;text-align: left;">name of the command whose arguments are being completed, so we can restrict this to completion for <span class="s33">configure</span>:</p><p class="s33" style="padding-top: 7pt;padding-left: 40pt;text-indent: 0pt;line-height: 115%;text-align: left;">zstyle  &#39;:completion:*:*:configure:*&#39;  tag-order  &#39;options:-other&#39;  options zstyle  &#39;:completion:*:options-other&#39;  ignored-patterns  &#39;--disable-*&#39;</p><p style="padding-top: 7pt;padding-left: 40pt;text-indent: 17pt;line-height: 115%;text-align: left;">The <span class="s33">options:-other </span>value in the tag order says that completion should be tried for the <span class="s33">options </span>tag but with the <span class="s33">other </span>label added to the context. This means that whenever a style is looked up as part of the option completion, the label will appear in the context. That label is therefore included in the context for the <span class="s33">ignored-patterns </span>style above. It isn’t necessary to restrict the <span class="s33">ignored-patterns </span>style to the <span class="s33">configure </span>command because restricting the tag to <span class="s33">options-other </span>should be sufficient, provided you don’t use the same tag label with options for another command.</p><p style="padding-left: 58pt;text-indent: 0pt;line-height: 10pt;text-align: left;">Using tag labels here isn’t actually necessary: we could just as easily have relied on the</p><p class="s33" style="padding-top: 1pt;padding-left: 40pt;text-indent: 0pt;line-height: 115%;text-align: left;">_ignored <span class="p">completer to pick up the </span>--disable <span class="p">options. To do that, we would need to specify the </span>ignored-patterns <span class="p">style with a context that selects the </span>configure <span class="p">command:</span></p><p class="s33" style="padding-top: 7pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">zstyle  &#39;:completion:*:*:configure:*:options&#39;  ignored-patterns  &#39;--disable-*&#39;</p><p style="padding-top: 8pt;padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">What makes tag labels more powerful is that they allow matches to be divided into more than two groups. Furthermore, if some style other than <span class="s33">ignored-patterns </span>has the effect of limiting matches, it could be used when separating matches into groups.</p><p style="padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">If more than one tag is listed in the same word in the value of the <span class="s33">tag-order </span>style, matches for both tags (or labels) are completed together. It is also possible to specify different descriptions for each tag label. So for <span class="s33">configure</span>, we can do this:</p><p class="s33" style="padding-top: 7pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">zstyle &#39;:completion:*:*:configure:*&#39; tag-order \</p><p class="s33" style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;line-height: 115%;text-align: left;">&#39;options:-enable:enable\  options  options:-other:other\  options&#39;  \ &#39;options:-disable:disable\  options&#39;</p><p class="s33" style="padding-left: 40pt;text-indent: 0pt;line-height: 115%;text-align: left;">zstyle &#39;:completion:*:options-enable&#39; ignored-patterns &#39;^--enable-*&#39; zstyle &#39;:completion:*:options-disable&#39; ignored-patterns &#39;^--disable-*&#39; zstyle &#39;:completion:*:options-other&#39; ignored-patterns &#39;--(en|dis)able-*&#39;</p><p style="padding-top: 7pt;padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">This now has three separate descriptions for the different sets of options. By putting the specification for enable options together in the same word as other options, they are still completed together.</p><p style="padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">Often, configure scripts also have similar <span class="s33">--with </span>and <span class="s33">--without </span>options. We can do the same trick for them. We need <span class="s33">ignored-patterns </span>styles for each of them and to extend the pattern for the other options:</p><p class="s33" style="padding-top: 7pt;padding-left: 40pt;text-indent: 0pt;line-height: 115%;text-align: left;">zstyle &#39;:completion:*:options-with&#39; ignored-patterns &#39;^--with-*&#39; zstyle &#39;:completion:*:options-without&#39; ignored-patterns &#39;^--without-*&#39; zstyle &#39;:completion:*:options-other&#39; ignored-patterns \</p><p class="s33" style="padding-left: 49pt;text-indent: 0pt;line-height: 10pt;text-align: left;">&#39;--((en|dis)able|with(|out))-*&#39;</p><p style="padding-top: 8pt;padding-left: 58pt;text-indent: 0pt;text-align: left;">We also need to replace our <span class="s33">tag-order </span>style with one that includes the two new labels.</p><p style="padding-top: 1pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">I’ll leave the descriptions out this time.</p><p class="s33" style="padding-top: 8pt;padding-left: 49pt;text-indent: -9pt;line-height: 115%;text-align: left;">zstyle  &#39;:completion:*:*:configure:*&#39;  tag-order  \ &#39;options:-enable  options:-with  options:-other&#39;  \ &#39;options:-disable  options:-without&#39;</p><p class="s29" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark809"><span class="s27">398 </span></a>C HA P T E R 15 <span class="s28">■ </span>W R I T I NG COMP LET I ON F UNCTI ON S</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">If you set up your <span class="s33">group-name </span>style as suggested in the section “Grouping Related Matches” in Chapter 10, you will now have separate groups for each type of option. This is because it is including the label in the group name. We can, however, override this by specifying the name for the group explicitly. The following style puts all the configure options back into the same group so that they are listed together:</p><p class="s33" style="padding-top: 7pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">zstyle  &#39;:completion:*:*:configure:*:options-*&#39;  group-name  options</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="507" height="1" alt="image" src="Image_312.png"/></span></p><p class="s21" style="padding-top: 4pt;padding-left: 42pt;text-indent: 0pt;line-height: 111%;text-align: left;">■<span class="s23">Tip </span><span class="s19">Another thing you may want to try instead of completing --without and --disable options later is to use the hidden style. It allows matches to be completed but to be left out of completion listings.</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="504" height="1" alt="image" src="Image_313.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part414.htm">&lt; Previous</a><span> | </span><a href="../From Bash to Z Shell.html">Contents</a><span> | </span><a href="part416.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
