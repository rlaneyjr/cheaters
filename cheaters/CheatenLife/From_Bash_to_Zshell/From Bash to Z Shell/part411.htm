<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Looking Up Styles Directly</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part410.htm">&lt; Previous</a><span> | </span><a href="../From Bash to Z Shell.html">Contents</a><span> | </span><a href="part412.htm">Next &gt;</a></p><p class="s35" style="padding-left: 42pt;text-indent: 0pt;text-align: left;"><a name="bookmark763">Looking Up Styles Directly</a></p><p style="padding-top: 5pt;padding-left: 41pt;text-indent: 0pt;line-height: 115%;text-align: left;">When we introduced the <span class="s33">zstyle </span>command in the sidebar “Configuring Completion Using Styles” in Chapter 10, we said that it allows styles to be defined. In addition, the <span class="s33">zstyle </span>command can be used to find out the value of a style. The usage is also similar: the familiar context and style name are there. The main difference is that an option is used to specify what type the value should be interpreted as. Table 15-2 lists the most useful of the available options.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-top: 4pt;padding-bottom: 4pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">Table 15-2. <span class="s32">Options to zstyle for Looking Up Styles</span></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="310" height="1" alt="image" src="Image_307.png"/></span></p><p class="s51" style="padding-top: 2pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">-<span class="s61">t </span>boolean (default <i>false</i>)</p><p class="s51" style="padding-top: 7pt;padding-left: 42pt;text-indent: 0pt;text-align: left;"><span class="s61">-T </span>boolean (default <i>true</i>)</p><p class="s61" style="padding-top: 7pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">-s <span class="s51">scalar (string)</span></p><p class="s61" style="padding-top: 5pt;padding-bottom: 4pt;padding-left: 42pt;text-indent: 0pt;text-align: left;">-a <span class="s51">array</span></p><p style="padding-left: 42pt;text-indent: 0pt;line-height: 1pt;text-align: left;"><span><img width="310" height="1" alt="image" src="Image_308.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 5pt;padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">With the <span class="s33">-s </span>and <span class="s33">-a </span>options, an additional argument specifies a variable into which the style’s value is put. To see this in action try running the following directly from the command line, which will return a list of the completers you use unless you rely on the defaults:</p><p class="s33" style="padding-top: 7pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">% <b>zstyle -a :completion::::: completer arr</b></p><p class="s33" style="padding-top: 1pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">% <b>print $arr</b></p><p class="s29" style="padding-top: 3pt;padding-left: 223pt;text-indent: 0pt;text-align: left;"><a name="bookmark804">CHAPTER 15 </a><span class="s28">■ </span>W RIT ING COMP LET ION F UNCTI ON S <span class="s27">393</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">When looking up styles from a completion function, you need to know the appropriate context to use. As we mentioned when discussing states and the <span class="s33">_arguments </span>function, the current context is passed around in the <span class="s33">curcontext </span>variable. To illustrate the use of this, let’s take an example. The completions for <span class="s33">scp </span>and <span class="s33">rcp </span>look up the <span class="s33">remote-access </span>style to check if it is okay for them to use <span class="s33">ssh </span>or <span class="s33">rsh </span>to connect to the remote system to obtain a list of files there. What they do is roughly as follows:</p><p class="s33" style="padding-top: 6pt;padding-left: 49pt;text-indent: -9pt;line-height: 115%;text-align: left;">if  zstyle  -T  &quot;:completion:${curcontext}:&quot;  remote-access;  then compadd  $(rsh  $host  ls  -1d  $PREFIX\*)</p><p class="s33" style="padding-left: 40pt;text-indent: 0pt;line-height: 10pt;text-align: left;">else</p><p class="s33" style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;text-align: left;">_message  &#39;remote  file&#39;</p><p class="s33" style="padding-top: 1pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">fi</p><p style="padding-top: 8pt;padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">We are only interested in a true or false value here, so we can simply use the exit status of <span class="s33">zstyle</span>. Our use of <span class="s33">-T </span>instead of <span class="s33">-t </span>indicates that the value true is assumed by default. If it is true, the first branch of the if statement will execute and <span class="s33">rsh </span>will be used to get a list of files on the remote system to complete. If it is false, it will instead just display a prompt. Note that the <span class="s33">curcontext </span>variable doesn’t include the initial <span class="s33">:completion: </span>prefix, so we need to specify that explicitly.</p><p style="padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: justify;">Where the style can have more values than just true or false, we need to specify the variable name. The return status will still indicate if the style is unset, allowing a default to be selected. For example, the <span class="s33">_pids </span>function contains the following line:</p><p class="s33" style="padding-top: 6pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">zstyle -s &quot;:completion:${curcontext}:processes&quot; insert-ids out || out=menu</p><p style="padding-top: 8pt;padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: justify;">Here, if the <span class="s33">insert-ids </span>style has not been set, it will default to the value <span class="s33">menu</span>. Note how the <span class="s33">processes </span>tag is added to the end of the context to indicate that we are completing process IDs. The tag is not carried around in the <span class="s33">curcontext </span>variable.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part410.htm">&lt; Previous</a><span> | </span><a href="../From Bash to Z Shell.html">Contents</a><span> | </span><a href="part412.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
