<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Special Effects</title><link href="navigation.css" rel="stylesheet" type="text/css"/><link href="document.css" rel="stylesheet" type="text/css"/></head><body><p class="top_nav"><a href="part156.htm">&lt; Previous</a><span> | </span><a href="../From Bash to Z Shell.html">Contents</a><span> | </span><a href="part158.htm">Next &gt;</a></p><p class="s35" style="padding-left: 42pt;text-indent: 0pt;text-align: left;"><a name="bookmark298">Special Effects</a></p><p style="padding-top: 5pt;padding-left: 41pt;text-indent: 0pt;line-height: 117%;text-align: left;">Many users like to make parts of their prompts stand out by using color, or to make the infor- mation that usually appears in prompts appear instead in the title bar of their terminal window.</p><p style="padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">As we’ll see, <span class="s33">zsh </span>has a few functions that are supplied with the shell to allow tricks using prepackaged “themes.” For <span class="s33">bash</span><a href="http://www.tldp.org/" class="a" target="_blank">, you need to search on the Web for that sort of thing. A good starting point is the “Bash Prompt HOWTO” available from the Linux Documentation Project, </a><a href="http://www.tldp.org/" class="s34" target="_blank">http://www.tldp.org/</a><a href="http://www.tldp.org/" class="a" target="_blank">. If</a><a href="http://www.google.com/" class="a" target="_blank"> you’re not on a GNU/Linux system, some of the more detailed infor- mation may not be relevant, but most of it will be. If you search with one of the well-known search engines such as Google, </a><a href="http://www.google.com/" class="s34" target="_blank">http://www.google.com/</a><a href="http://www.google.com/" class="a" target="_blank">, </a>with keywords such as <span class="s33">bash  prompt themes</span>, you will find lots of suggestions; at the time of writing, however, there didn’t seem to be a permanent home for these.</p><p style="padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">Many of the special effects are not performed by the shell, but by the terminal. To produce them you have to send special sequences to the terminal, another set of escape sequences different from the ones used in prompts. Detailed information on programming terminals is beyond the scope of this book, but we will introduce the subject, and how to make use of the terminal’s features from inside prompts.</p><p style="padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: justify;">The possible effects include changing the appearance of the following piece of output text, for example, by emboldening it, underlining it, or coloring it. The effect lasts until it is reset by another escape sequence. Because this is handled by the terminal, the same effects are possible in both <span class="s33">bash </span>and <span class="s33">zsh</span>, and we’ll show examples for both.</p><p style="padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">The sequences are usually introduced by an escape character. This sequence is produced by your keyboard’s Esc key. When it’s used as input, the terminal does not intercept the <span class="s33">ESCAPE</span>; only outputting it from the shell has the special effect we need here. Here’s an example of a sequence you can output in <span class="s33">bash </span>or <span class="s33">zsh</span>:</p><p class="s33" style="padding-top: 6pt;padding-left: 41pt;text-indent: 0pt;line-height: 115%;text-align: left;">%  <b>echo  -e  &quot;\e[1mWHAM\e[0m&quot; WHAM</b></p><p style="padding-top: 7pt;padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">The “WHAM” should be in bold text. The <span class="s33">-e </span>option causes <span class="s33">echo </span>to turn the <span class="s33">\e </span>into escape characters. The sequence <span class="s33">\e[1m </span>turns bold on, and <span class="s33">\e[0m </span>turns it off again.</p><p style="padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">Although not all terminals understand these sequences, they are standardized. They are often referred to as “ANSI sequences” from the standards organization that promoted them, although the relevant international standard is ISO 6429. Recent terminal emulators have acquired the ability to do color using escape sequences. If this is supported on your terminal, the following will produce red text on a yellow background. (With some terminals, it may be brown, which is harder to see.) The <span class="s33">\e[31m </span>produces the red foreground, and the <span class="s33">\e[43m </span>produces the yellow background. We use <span class="s33">\e[0m </span>at the end to turn all effects off:</p><p class="s33" style="padding-top: 7pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">%  <b>echo  -e  &quot;\e[31m\e[43mWHAM\e[0m&quot;</b></p><p class="s33" style="padding-top: 1pt;padding-left: 41pt;text-indent: 0pt;text-align: left;">WHAM</p><p style="padding-top: 8pt;padding-left: 41pt;text-indent: 18pt;line-height: 115%;text-align: left;">To use these in prompts, you must surround them with prompt escape sequences that tell the shell that the characters inside don’t produce any output. (Remember, prompt escapes and terminal escapes are quite different things.) This is so that the shell knows that the escape sequences don’t move the cursor, so it can keep track of the position on the command line. In <span class="s33">bash</span>, you need to put <span class="s33">\[ </span>before the sequence and <span class="s33">\] </span>after it. Because we aren’t using the <span class="s33">echo</span></p><p class="s29" style="padding-top: 3pt;padding-left: 39pt;text-indent: 0pt;text-align: right;"><a name="bookmark327">CHAPTER 7 </a><span class="s28">■ </span>PROMPT S <span class="s27">149</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 40pt;text-indent: 0pt;line-height: 115%;text-align: left;">command, we need another way of inserting escape characters. We can do this by using the special version of quotes introduced by <span class="s33">$&#39;</span>. Here is an example:</p><p class="s33" style="padding-top: 7pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">bash$ <b>PS1=$&#39;\[\e[31m\e[43m\]\W\[\e[0m\]\$ &#39;</b></p><p class="s33" style="padding-top: 1pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">book$</p><p style="padding-top: 8pt;padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">This puts the last word of the current directory (called <span class="s33">book</span>) in red on yellow, followed by a <span class="s33">$ </span>and a space. The actual colors vary a bit between terminals. In <span class="s33">zsh</span>, the escape sequence should be surrounded by <span class="s33">%{ </span>and <span class="s33">%}</span>:</p><p class="s33" style="padding-top: 7pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">zsh% <b>PS1=$&#39;%{\e[31m\e[43m%}%1~%{\e[0m%}%# &#39;</b></p><p class="s33" style="padding-top: 1pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">book%</p><p style="padding-top: 8pt;padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">In many terminal emulators, terminal escape sequences exist for putting strings into the title bar. The following puts the complete current directory into the title bar of an <span class="s33">xterm </span>using <span class="s33">bash</span>:</p><p class="s33" style="padding-top: 7pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">bash$ <b>PS1=$&#39;\[\e]2;\]\w\[\a\]\$ &#39;</b></p><p class="s33" style="padding-top: 1pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">$</p><p style="padding-top: 8pt;padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">Everything before the <span class="s33">\$ </span>refers to the title bar, so only the <span class="s33">$ </span>and the space are left on the command line. Translating this for <span class="s33">zsh </span>is left as an exercise for the reader.</p><p style="padding-left: 40pt;text-indent: 18pt;line-height: 115%;text-align: left;">In Table 7-5 we show numbers for standard colors understood by most terminals, both to use the color in the foreground and to use in the background. See our earlier examples for where you should place the number. Note that what is described as yellow may be brown on some terminals, whereas what is described as white may appear gray. In addition to the colors, there are various special codes. The code 0 restores the default colors (foreground and back- ground), 1 produces brighter colors, 4 produces underlined text, and 5 produces flashing text. Often 5 doesn’t work; however, many consider the effect to be distracting so this is really not an issue for most users. Also, keep in mind not all terminals are capable of underlining and as a result code 4 may produce some other effect.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s13" style="padding-top: 8pt;padding-left: 40pt;text-indent: 0pt;text-align: left;">Table 7-5. <span class="s32">Color Codes Used in Terminal Escapes</span></p><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:40.2pt" cellspacing="0"><tr style="height:15pt"><td style="width:42pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s56" style="text-indent: 0pt;text-align: left;">Color</p></td><td style="width:110pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s56" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">Code for Foreground</p></td><td style="width:123pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s56" style="padding-left: 16pt;text-indent: 0pt;text-align: left;">Code for Background</p></td></tr><tr style="height:18pt"><td style="width:42pt;border-top-style:solid;border-top-width:1pt"><p class="s57" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">Black</p></td><td style="width:110pt;border-top-style:solid;border-top-width:1pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">30</p></td><td style="width:123pt;border-top-style:solid;border-top-width:1pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">40</p></td></tr><tr style="height:18pt"><td style="width:42pt"><p class="s57" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">Red</p></td><td style="width:110pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">31</p></td><td style="width:123pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">41</p></td></tr><tr style="height:18pt"><td style="width:42pt"><p class="s57" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">Green</p></td><td style="width:110pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">32</p></td><td style="width:123pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">42</p></td></tr><tr style="height:18pt"><td style="width:42pt"><p class="s57" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">Yellow</p></td><td style="width:110pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">33</p></td><td style="width:123pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">43</p></td></tr><tr style="height:18pt"><td style="width:42pt"><p class="s57" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">Blue</p></td><td style="width:110pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">34</p></td><td style="width:123pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">44</p></td></tr><tr style="height:18pt"><td style="width:42pt"><p class="s57" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">Purple</p></td><td style="width:110pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">35</p></td><td style="width:123pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">45</p></td></tr><tr style="height:17pt"><td style="width:42pt"><p class="s57" style="padding-top: 3pt;text-indent: 0pt;text-align: left;">Cyan</p></td><td style="width:110pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">36</p></td><td style="width:123pt"><p class="s57" style="padding-top: 3pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">46</p></td></tr><tr style="height:17pt"><td style="width:42pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s57" style="padding-top: 2pt;text-indent: 0pt;text-align: left;">White</p></td><td style="width:110pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s57" style="padding-top: 2pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">37</p></td><td style="width:123pt;border-bottom-style:solid;border-bottom-width:1pt"><p class="s57" style="padding-top: 2pt;padding-left: 16pt;text-indent: 0pt;text-align: left;">47</p></td></tr></table><p class="s29" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark328"><span class="s27">150 </span></a>CHAPTER 7 <span class="s28">■ </span>PROMPTS </p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 60pt;text-indent: 0pt;text-align: left;">You can find more information on terminal escape sequences in the <span class="s33">zsh </span>function <span class="s33">colors</span>.</p><p style="padding-top: 1pt;padding-left: 41pt;text-indent: 0pt;line-height: 115%;text-align: left;">This function is installed with the prompt theme system described in the section “Prompt Themes,” later in this chapter. The various functions for the <span class="s33">zsh </span>prompt themes also provide examples. The Linux Documentation Project has a description of <span class="s33">xterm </span><a href="http://www.tldp.org/HOWTO/Xterm-Title.html" class="a" target="_blank">title bars at </a><a href="http://www.tldp.org/HOWTO/Xterm-Title.html" class="s34" target="_blank">http://www.tldp.org/HOWTO/Xterm-Title.html</a><a href="http://www.tldp.org/HOWTO/Xterm-Title.html" target="_blank">.</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="nav">&nbsp;&nbsp;</p><p class="nav">&nbsp;</p><p class="nav"><a href="part156.htm">&lt; Previous</a><span> | </span><a href="../From Bash to Z Shell.html">Contents</a><span> | </span><a href="part158.htm">Next &gt;</a></p><p class="nav">&nbsp;&nbsp;</p></body></html>
