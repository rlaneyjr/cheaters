<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>PKI / openSSL Cheat Sheet by mdoehle - Cheatography.com</title><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 .s1 { color: #FFF; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7.5pt; }
 .h1, h1 { color: #45463A; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7.5pt; }
 p { color: #45463A; font-family:Courier, serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7.5pt; margin:0pt; }
 .s2 { color: #45463A; font-family:Courier, serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7.5pt; }
 .s4 { color: #45463A; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 a { color: #2E11A2; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
</style></head><body><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">Certificate Signing Request (CSR) Performance</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Check the SSL performance</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;">openssl speed sha1 openssl speed aes-256-cbc</p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl speed -evp aes-256-cbc</p><p style="padding-left: 278pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Generate a new private key and Certificate Signing Request</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl req -out CSR.csr -new -newkey rsa:2048 -nodes</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;">-sha256 -keyout privateKey.key</p><h1 style="padding-top: 5pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Generate a self-signed certificate</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;line-height: 183%;text-align: left;">openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout privateKey.key -out certificate.crt <span class="h1">Generate a certificate signing request (CSR) for an existing private</span></p><h1 style="padding-left: 4pt;text-indent: 0pt;line-height: 6pt;text-align: left;">key</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;line-height: 165%;text-align: left;">openssl req -out CSR.csr -key privateKey.key -new <span class="h1">Generate a certificate signing request based on an existing certificate</span></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;">openssl x509 -x509toreq -in certificate.crt -out CSR.csr -signkey privateKey.key</p><h1 style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Remove a passphrase from a private key</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl rsa -in privateKey.pem -out newPrivateKey.pem</p><p style="text-indent: 0pt;text-align: left;"/><p class="s1" style="padding-top: 4pt;padding-left: 283pt;text-indent: 0pt;text-align: left;">How to get a A+ at SSL-Labs</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Check versions</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;"># openssl version</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;">OpenSSL 1.0.1e 11 Feb 2013</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;"># apache2 -v</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 183%;text-align: left;">Server version: Apache/2.2.22 (Debian) Server built: Aug 18 2015 09:50:52 <span class="h1">Enable mods</span></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">a2enmod ssl</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 183%;text-align: left;">a2enmod headers a2enmod setenvif <span class="h1">Configure virtual host</span></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">SSLEngine on</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;">SSLHonorCipherOrder On</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;">SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDHE- ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM- SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-DSS-AES128- GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-E SSLProtocol -ALL +TLSv1 +TLSv1.1 +TLSv1.2</p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;"><a href="http://www.example.com.pem/" class="s2" target="_blank">SSLCertificateFile /etc/ssl/</a><a href="http://www.example.com.key/" class="s2" target="_blank">www.example.com.pem SSLCertificateKeyFile /etc/ssl/</a>www.example.com.key SSLCertificateChainFile /etc/ssl/chain.pem</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">SSLStrictSNIVHostCheck On</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;">Header always set Strict-Transport-Security &quot;max- age=63072000; includeSubdomains; preload&quot;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;">&lt;FilesMatch &quot;\.(cgi|shtml|phtml|php)$&quot;&gt; SSLOptions +StdEnvVars</p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;">&lt;/FilesMatch&gt;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;">&lt;Directory /usr/lib/cgi-bin&gt; SSLOptions +StdEnvVars</p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;">&lt;/Directory&gt;</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;line-height: 14pt;text-align: left;">BrowserMatch &quot;MSIE [2-6]&quot; \ nokeepalive ssl-unclean-shutdown \ downgrade-1.0 force-response-1.0</p><p style="text-indent: 0pt;text-align: left;"/><p class="s1" style="padding-top: 4pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">Check Files</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Check a Certificate Signing Request (CSR)</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl req -text -noout -verify -in CSR.csr</p><h1 style="padding-top: 5pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Check a private key</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl rsa -in privateKey.key -check</p><h1 style="padding-top: 5pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Check a certificate</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl x509 -in certificate.crt -text -noout</p><h1 style="padding-top: 5pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Check a PKCS#12 file (.pfx or .p12)</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl pkcs12 -info -in keyStore.p12</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-top: 4pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">Debugging</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">Print certificate</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;line-height: 165%;text-align: left;">openssl x509 -noout -text -in certificate.crt <span class="h1">Check an SSL connection. All the certificates (including Intermediates) should be displayed</span></p><p style="padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl s_client -connect <span style=" color: #2E11A2;">www.paypal.com:443</span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-top: 4pt;padding-left: 10pt;text-indent: 0pt;text-align: left;">Remove Passphrase</p><p style="text-indent: 0pt;text-align: left;"><br/></p><h1 style="padding-top: 4pt;padding-left: 4pt;text-indent: 0pt;line-height: 156%;text-align: left;">Convert a PKCS#12 file (.pfx .p12) containing a private key and certificates to PEM</h1><p style="padding-top: 1pt;padding-left: 4pt;text-indent: 0pt;line-height: 192%;text-align: left;">openssl pkcs12 -in keyStore.p12 -out keyStore.pem - nodes</p><h1 style="padding-left: 4pt;text-indent: 0pt;line-height: 7pt;text-align: left;">Remove Passphrase from key-file</h1><p style="padding-top: 6pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">openssl rsa -in example.key -out example.nocrypt.key</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 254pt;text-indent: 0pt;text-align: center;">By <b>mdoehle</b></p><p style="padding-top: 4pt;padding-left: 60pt;text-indent: 0pt;text-align: left;"><a href="http://www.cheatography.com/mdoehle/">cheatography.com/mdoehle/</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 33pt;text-indent: 0pt;text-align: left;">Published 31st August, 2015.</p><p class="s4" style="padding-top: 3pt;padding-left: 33pt;text-indent: 0pt;line-height: 145%;text-align: left;">Last updated 1st September, 2015. Page 1 of 2.</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 59pt;text-indent: 0pt;line-height: 150%;text-align: left;">Sponsored by <b>Readability-Score.com </b><a href="https://readability-score.com/" style=" color: #45463A; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt;" target="_blank">Measure your website readability! </a><a href="https://readability-score.com/" target="_blank">https://readability-score.com</a></p><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s1" style="padding-left: 10pt;text-indent: 0pt;text-align: left;">How to get a A+ at SSL-Labs (cont)</p><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="padding-left: 4pt;text-indent: 0pt;line-height: 14pt;text-align: left;"># MSIE 7 and newer should be able to use keepalive BrowserMatch &quot;MSIE [17-9]&quot; ssl-unclean-shutdown</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"/><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s4" style="padding-top: 4pt;padding-left: 254pt;text-indent: 0pt;text-align: center;">By <b>mdoehle</b></p><p style="padding-top: 4pt;padding-left: 60pt;text-indent: 0pt;text-align: left;"><a href="http://www.cheatography.com/mdoehle/">cheatography.com/mdoehle/</a></p><p class="s4" style="padding-top: 4pt;padding-left: 33pt;text-indent: 0pt;text-align: left;">Published 31st August, 2015.</p><p class="s4" style="padding-top: 3pt;padding-left: 33pt;text-indent: 0pt;line-height: 145%;text-align: left;">Last updated 1st September, 2015. Page 2 of 2.</p><p class="s4" style="padding-top: 4pt;padding-left: 59pt;text-indent: 0pt;line-height: 150%;text-align: left;">Sponsored by <b>Readability-Score.com </b><a href="https://readability-score.com/" style=" color: #45463A; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt;" target="_blank">Measure your website readability! </a><a href="https://readability-score.com/" target="_blank">https://readability-score.com</a></p></body></html>
